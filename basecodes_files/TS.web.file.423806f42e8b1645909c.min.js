(window.webpackJsonp=window.webpackJsonp||[]).push([["TS.web.file"],{"fc/B":function(e,i){!function(){TS.registerModule("web.file",{file_id:null,file_loaded:new signals.Signal,onStart:function(){TS.web.login_sig.add(TS.web.file.onLogin,TS.web.file,1),TS.files.team_file_changed_sig.add(TS.web.file.teamFileChanged,TS.web.file),TS.files.team_file_comment_deleted_sig.add(TS.web.file.teamFileCommentDeleted,TS.web.file),TS.files.team_file_deleted_success_sig.add(e),TS.web.file.bindEvents()},bindEvents:function(){$("body").on("click",".action_cog",(function(e){TS.menu.file.startWithFileActions(e,TS.web.file.file_id)}))},onLogin:function(){if(TS.boot_data.file){var e=TS.files.upsertFile(TS.boot_data.file).file;TS.web.file.file_id=e.id}(TS.boot_data.file?Promise.all([TS.members.legacyEnsureMembersInDataArePresent(TS.boot_data.file),TS.bots.legacyEnsureBotsInDataArePresent(TS.boot_data.file)]):Promise.resolve()).then((function(){if(TS.boot_data.file){TS.utility.makeSureAllExternalLinksAreRefererSafe($(".post_body"));var e,i=TS.files.getFileById(TS.web.file.file_id);if("USLACKBOT"===i.user&&i.bot_id?((e=TS.interop.bots.getBotById(i.bot_id)).is_bot=!0,e.is_service=!0):e=TS.interop.members.getMemberById(i.user),$(".file_header_container").html(TS.templates.file_header({file:i,download:"hosted"===i.mode,member:e,is_post:"space"===i.mode||"post"===i.mode,preview:!0})),"email"===i.mode){var t={file:i,show_file_actions_cog:!1,to_more_count:i.to.length-1,cc_more_count:i.cc.length-1};$("#file_page_email").html(TS.templates.file_email(t))}$(".star").bind("click.file",TS.stars.checkForStarClick),$("#file_public_link_revoker").bind("click",(function(){TS.web.file.revokePublicURL(i)})),$("#post_share_btn").on("click",(function(){TS.ui.share_dialog.start(TS.web.file.file_id)}))}$("#snippet_expand_toggle").on("click",(function(){var e;$(this).find("i").toggleClass("hidden"),$("#page_contents").toggleClass("full_width"),e=!TS.prefs.getPref("expand_snippets"),TS.prefs.setPrefLocal("expand_snippets",e),TS.prefs.setPrefByAPI({name:"expand_snippets",value:e})})),$(".guide_toggle").on("click",(function(){var e;$("#formatting_col").toggleClass("hidden"),$("#post_col").toggleClass("span_4_of_6 span_1_of_1"),$(".guide_toggle").toggleClass("hidden"),e=!TS.prefs.getPref("posts_formatting_guide"),TS.prefs.setPrefLocal("posts_formatting_guide",e),TS.prefs.setPrefByAPI({name:"posts_formatting_guide",value:e})})),setTimeout((function(){$("#title").focus()}),0)}))},revokePublicURL:function(e){var i=TS.interop.i18n.t("Revoke public file link","files")(),t="<p>"+TS.interop.i18n.t("This will disable the Public Link for this file, and will cause any previously shared links to stop working.","files")()+"</p>";t+=TS.interop.i18n.t("Are you sure you want to revoke this public link?","files")(),TS.generic_dialog.start({title:i,body:t,show_cancel_button:!0,show_go_button:!0,go_button_text:TS.interop.i18n.t("Revoke it","files")(),go_button_class:"btn_warning",onGo:function(){$(".file_public_link_shared").slideToggle(100),TS.files.upsertAndSignal({id:e.id,public_url_shared:!1});var i=function(e,i){i.file&&TS.files.upsertAndSignal(i.file)};return TS.interop.api.callExpedited("files.revokePublicURL",{file:e.id}).then((function(e){var t=e.data,l=e.args,n=e.request_id;return i(0,t),{data:t,args:l,request_id:n}})).catch((function(e){var t=e.data,l=e.args,n=e.request_id;return i(0,t),{data:t,args:l,request_id:n}}))}})},teamFileChanged:function(e){$(".file_public_link").attr("href",e.permalink_public),e.public_url_shared?$(".file_public_link_shared").slideDown(100):$(".file_public_link_shared").slideUp(100);var i=TS.emoji.graphicReplace(e.title);$("#file_title").html(i)},teamFileCommentDeleted:function(e,i){TS.ui.comments.removeFileComment(e,i)},onPostShare:function(e,i,t){var l=TS.redux.channels.getEntityById(t.channel),n=l.name;l.is_channel&&(n="#"+l.name);var o=$('<p id="file_share_alert" class="alert alert_success no_print"><i class="ts_icon ts_icon_check_circle_o"></i> File shared to <a href="/archives/'+l.id+'">'+n+"</a>.</p>");$("#file_share_alert").length?$("#file_share_alert").replaceWith(o):$(".alert_container").append(o),$("#draft_mode_alert").remove(),$("#post_status_draft").remove(),l.is_channel&&$("#post_status_private").remove()},deleteFile:function(e){var i,t,l,n=TS.files&&TS.files.getFileById?TS.files.getFileById(e):null;n&&n.filetype&&"space"===n.filetype?(i=TS.interop.i18n.t("Delete post","files")(),t=TS.interop.i18n.t("Are you sure you want to delete this post permanently?","files")(),l=TS.interop.i18n.t("Yes, delete this post","files")()):(i=TS.interop.i18n.t("Delete file","files")(),t=TS.interop.i18n.t("Are you sure you want to delete this file permanently?","files")(),l=TS.interop.i18n.t("Yes, delete this file","files")()),TS.generic_dialog.start({title:i,body:t,show_cancel_button:!0,show_go_button:!0,go_button_class:"btn_danger",go_button_text:l,cancel_button_text:TS.interop.i18n.t("Cancel","files")(),onGo:function(){TS.interop.api.call("files.delete",{file:e}).then((function(e){var i=e.data,t=e.args,l=e.request_id;return TS.web.file.onFileDelete&&TS.web.file.onFileDelete(!0,i,t,l),{data:i,args:t,request_id:l}})).catch((function(e){var i=e.data,t=e.args,l=e.request_id;return TS.web.file.onFileDelete&&TS.web.file.onFileDelete(!1,i,t,l),{data:i,args:t,request_id:l}}))}})},onFileDelete:function(e,i,t){e?TS.files.team_file_deleted_success_sig.dispatch(t.file):TS.generic_dialog.alert(TS.interop.i18n.t("There was a problem deleting this file. Please try again.","files")())},test:function(){return{_teamFileDeleted:e}}});var e=function(e){e==TS.web.file.file_id&&TS.generic_dialog.start({body:"<p>"+TS.interop.i18n.t("This file has been deleted!","files")()+"</p>",show_cancel_button:!1,esc_for_ok:!0,onGo:function(){null!=TS.interop.environment.desktop_app_version?window.close():document.location.replace("/files")},unique:"file_deleted_"+e})}}()}},[["fc/B","webpack.manifest"]]]);